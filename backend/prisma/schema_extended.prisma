// 扩展后的用户资料表设计
model user_profiles {
  id               String    @id
  userId           String    @unique

  // 基础信息
  phone            String?
  wechat           String?
  birthDate        DateTime?
  nationality      String?

  // 学术背景
  currentEducation String?
  gpa              Float?
  lastTwoYearsGpa  Float?
  major            String?
  graduationDate   DateTime?
  undergraduateUniversity String?
  universityRank   Int?
  universityType   String?  // 'overseas', '985_211', 'regular', 'unknown'

  // 标准化考试成绩
  toefl            Int?
  ielts            Float?
  gre              Int?
  gmat             Int?

  // 语言详细成绩 (JSON)
  toeflDetails     Json?    // {reading: 28, listening: 29, speaking: 23, writing: 25}
  ieltsDetails     Json?    // {reading: 8.0, listening: 7.5, speaking: 7.0, writing: 7.5}
  greDetails       Json?    // {verbal: 160, quantitative: 165, analytical: 4.0}

  // 经历背景 (JSON Arrays)
  workExperiences  Json?    // Array of work experience objects
  internshipExperiences Json? // Array of internship objects
  researchProjects Json?    // Array of research project objects
  extracurricularActivities Json? // Array of activity objects
  awards           Json?    // Array of award objects

  // 推荐信信息 (JSON)
  recommendationLetters Json? // Array of recommendation letter objects

  // 技能相关
  programmingSkills Json?   // Array of programming skills
  languageSkills   Json?    // Array of language proficiency objects

  // 申请相关
  targetDegreeType String?  // 'undergraduate', 'masters', 'phd'
  targetMajors     Json?    // Array of target majors
  targetCountries  Json?    // Array of target countries
  applicationYear  String?
  applicationTerm  String?  // 'fall', 'spring', 'summer'

  // 个人发展
  goals            String?
  careerGoals      String?
  personalStatement String?
  researchInterests Json?   // Array of research interest areas

  // 财务与生活偏好
  budgetRange      String?
  scholarshipNeeds Boolean?
  preferredCityType String? // 'urban', 'suburban', 'rural', 'any'
  climatePreference String?
  campusSize       String?  // 'small', 'medium', 'large', 'any'

  // 推荐模型特征标签 (计算字段)
  gpaTag           Float?   // GPA等级标签
  paperTag         Float?   // 论文标签
  toeflTag         Float?   // 语言成绩标签
  greTag           Float?   // GRE标签
  researchTag      Float?   // 科研经历标签
  collegeTypeTag   Float?   // 院校类型标签
  recommendationTag Float?  // 推荐信质量标签
  networkingTag    Float?   // 套磁标签

  // 计算的feature值
  hasResearchExperience Boolean? @default(false)
  publicationCount Int? @default(0)
  totalWorkMonths  Int? @default(0)
  leadershipScore  Float? @default(0)

  // 系统字段
  experiences      Json?    // 兼容旧字段
  createdAt        DateTime  @default(now())
  updatedAt        DateTime
  users            users     @relation(fields: [userId], references: [id], onDelete: Cascade)
}

// 新增：用户申请历史追踪
model user_application_history {
  id               String    @id @default(uuid())
  userId           String
  schoolName       String
  programName      String
  applicationYear  String
  result           String    // 'accepted', 'rejected', 'waitlisted', 'pending'
  resultDate       DateTime?
  profileSnapshot  Json      // 申请时的用户资料快照
  predictionScore  Float?    // 当时的模型预测分数
  createdAt        DateTime  @default(now())
  users            users     @relation(fields: [userId], references: [id], onDelete: Cascade)
}

// 用户数据同步状态追踪
model user_data_sync_status {
  id               String    @id @default(uuid())
  userId           String    @unique
  lastSyncAt       DateTime?
  syncStatus       String    @default("pending") // 'synced', 'pending', 'error'
  syncErrors       Json?     // 同步错误记录
  mongodbSynced    Boolean   @default(false)
  aiServiceSynced  Boolean   @default(false)
  createdAt        DateTime  @default(now())
  updatedAt        DateTime
  users            users     @relation(fields: [userId], references: [id], onDelete: Cascade)
}